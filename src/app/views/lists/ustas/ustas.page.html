<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button text='' color="light" defaultHref="/dashboard" text='' color="light"></ion-back-button>
    </ion-buttons>
    <ion-title text-center>{{sections}}</ion-title>
    <ion-buttons slot="end">
      <ion-button expand="block" fill="outline" [color]="(filter_affec)?'danger':'light'" (click)="openFilter()">
        <ion-icon slot="start" name="funnel"></ion-icon>
      </ion-button>
      <ion-button color="light" (click)="showSearch = !showSearch" fill="outline" color="light">
        <ion-icon name=search></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
  <ion-grid fixed>
    <ion-row *ngIf="finishLoading" no-padding>
      <ion-col size="6">
        <ion-label text-center color="primary">
            <ion-select  color="primary" cancelText="إلغاء" [(ngModel)]="filterdSubSection" (ionChange)="filterSubSection($event)" interface="action-sheet" placeholder=" تصنيف الأكل" text-right> 
                <ion-select-option color="primary" value="{{sub.id}}"    *ngFor="let sub of subSections">{{sub.title}}</ion-select-option>
                </ion-select>
        </ion-label>
      </ion-col>
      <ion-col size="6">
        <ion-label text-center color="primary">
            <ion-select  color="primary" cancelText="إلغاء" [(ngModel)]="filteredCountry" (ionChange)="FilterCountry($event)"  interface="action-sheet" placeholder="حسب الموقع" text-right> 
                <ion-select-option color="primary" value="{{country.id}}"    *ngFor="let country of countries">{{country.country}}</ion-select-option>
                </ion-select>
        </ion-label>
      </ion-col>
    </ion-row>
    <ion-row no-padding *ngIf="showSearch">
      <ion-col size="12">
        <ion-searchbar [@fadeInOnEnter] [@fadeOutOnLeave] text-right animated cancelButtonText="إلغاء" color="light"
          placeholder="....البحث" [(ngModel)]="searchTerm" (ionChange)="filterustas()" clear-icon autocomplete>
        </ion-searchbar>
      </ion-col>
    </ion-row>
  </ion-grid>
  <ion-grid *ngIf="closeFilter" style="background-color: beige;">
    <ion-row >
    <ion-col size="12" style="padding-left:320px">
        <ion-chip outline color="primary" (click)="Reset()" >
            <ion-label>إلغاء </ion-label>
            <ion-icon name="close-circle"></ion-icon>
          </ion-chip>
    </ion-col>
  </ion-row>
</ion-grid>
</ion-header>

<ion-content [ngClass]="{'nodata' : (pagedUstas && pagedUstas.length == 0)}">
    <ng-container *ngIf="!pagedUstas">
        <div *ngFor="let n of [0,1,2]" padding>
          <ion-skeleton-text></ion-skeleton-text>
          <p>
            <ion-skeleton-text class="fake-skeleton"></ion-skeleton-text>
          </p>
        </div>
      </ng-container>
      <ng-container *ngIf="pagedUstas && pagedUstas.length > 0">
          <ion-list>
              <ion-card  *ngFor="let item of pagedUstas" [routerLink]="['/resturantprofile', item.id]" detail="false">
                <ion-card-header>
                    <ion-img no-padding src="{{item.img_profile}}"  *ngIf="item.img_profile" ></ion-img>
                    <ion-img src="assets/img/{{item.sex}}.png" *ngIf="!item.img_profile && item.sex "></ion-img>
                    <ion-img src="assets/img/male.png" *ngIf="!item.img_profile && !item.sex "></ion-img>
                  <ion-card-subtitle text-right> </ion-card-subtitle>
                  <ion-card-title color="primary" text-center>{{item.name}}</ion-card-title>
                </ion-card-header>
              
                <ion-card-content text-wrap  text-center>
                    {{item.description}}
                </ion-card-content>
                <ion-item detail="false" lines="none">
                    <ion-chip outline="true" color="primary">{{item.ustarate}} / 5 </ion-chip>
                  <ion-label text-wrap  text-right color="danger">{{item.address}}</ion-label>
                  <ion-icon name="pin" slot="end" color="danger"></ion-icon>
                </ion-item>
              </ion-card>
            </ion-list>
            <ion-infinite-scroll threshold="100px" (ionInfinite)="loadData($event)">
              <ion-infinite-scroll-content loadingSpinner="dots" loadingText="">
              </ion-infinite-scroll-content>
            </ion-infinite-scroll>
          </ng-container>

</ion-content>
